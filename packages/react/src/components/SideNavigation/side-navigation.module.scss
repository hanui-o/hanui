/**
 * KRDS Side Navigation Component
 * Self-contained SCSS Module
 *
 * Based on KRDS Design System
 * Supports up to 4 depth levels
 */

.krds-side-navigation {
  // Container
  width: 100%;
  max-width: 296px;
  padding: 40px 40px 40px 0;
  background-color: var(--krds-light-color-surface-white, #ffffff);

  // Screen reader only
  .srOnly {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }
}

// 1st Depth: Title
.lnb-tit {
  padding: 0 0.8rem 1.6rem 0.8rem;
  margin: 0;
  border-bottom: 1px solid var(--krds-light-color-divider-gray-dark, #8a949e);
  font-size: 24px;
  font-weight: 700;
  line-height: 1.4;
  color: var(--krds-light-color-text-basic, #1e2124);
}

// 2nd Depth: List container
.lnb-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

// 2nd Depth: Menu item
.lnb-item {
  position: relative;

  &:not(:last-child) {
    margin-bottom: 0;
  }
}

// Base button/link styles (All depths)
.lnb-btn {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: 1.2rem 0.8rem;
  border: 0;
  border-bottom: 1px solid var(--krds-light-color-divider-gray-light, #e6e8ea);
  background-color: transparent;
  font-size: 17px;
  font-weight: 400;
  line-height: 1.5;
  color: var(--krds-light-color-text-basic, #1e2124);
  text-align: left;
  text-decoration: none;
  cursor: pointer;
  transition: all 0.2s ease;

  &::before {
    content: '';
    display: inline-flex;
    content: "";
    position: absolute;
    bottom: -1px;
    left: 0%;
    width: 0;
    height: 3px;
    background-color: #063a74;
    transition: 0.4s ease-in-out;
  }

  &:hover {
    background-color: var(
      --krds-light-color-action-secondary-hover,
      rgba(0, 0, 0, 0.04)
    );
    &::before {
      width: 100%;
    }
  }

  &:focus-visible {
    outline: 2px solid var(--krds-light-color-action-primary, #0066ff);
    outline-offset: -2px;
  }

  // Active state
  &[aria-current='page'] {
    font-weight: 700;
    color: var(--krds-light-color-action-primary, #0066ff);
  }
}

// 2nd Depth: Toggle button with chevron icon
.lnb-toggle {
  position: relative;
  font-weight: 700;

  &::after {
    content: '';
    display: inline-block;
    width: 20px;
    height: 20px;
    flex-shrink: 0;
    background-image: url("https://www.krds.go.kr/resources/img/component/icon/ico_angle.svg");
    background-repeat: no-repeat;
    background-position: center;
    background-size: contain;
    transition: transform 0.2s ease;
  }

  &[data-state='open']::after {
    transform: rotate(180deg);
  }
}

// 2nd Depth: Active state (blue border)
.lnb-item.active > .lnb-btn {
  border: 2px solid var(--krds-light-color-action-primary, #0066ff);
  border-radius: 0.8rem;
  padding: 1rem 0.6rem; // Adjust for border
  margin-bottom: 0.2rem;

  &.lnb-toggle::after {
    background-image: url("https://www.krds.go.kr/resources/img/component/icon/ico_angle.svg");
  }
}

// 3rd Depth: Submenu container
.lnb-submenu {
  overflow: hidden;

  &[data-state='open'] {
    animation: slideDown 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  &[data-state='closed'] {
    animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  > ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }
}

// 3rd Depth: Submenu item
.lnb-subitem {
  position: relative;

  .lnb-btn {
    padding-left: 2.4rem;
    font-weight: 400;
    border-bottom: 0;

    // Bullet point
    &::before {
      content: '•';
      position: absolute;
      left: 0.8rem;
      font-size: 1.6rem;
      color: var(--krds-light-color-text-subtle, #6d7882);
    }

    &:hover {
      background-color: transparent;
      text-decoration: underline;
    }

    &[aria-current='page'] {
      font-weight: 700;
      color: var(--krds-light-color-action-primary, #0066ff);
      text-decoration: underline;

      &::before {
        color: var(--krds-light-color-action-primary, #0066ff);
      }
    }
  }

  // 3rd Depth Active state
  &.active > .lnb-btn {
    font-weight: 700;
    color: var(--krds-light-color-action-primary, #0066ff);

    &::before {
      color: var(--krds-light-color-action-primary, #0066ff);
    }
  }
}

// 3rd Depth: Toggle button (for 4th depth)
.lnb-toggle-popup {
  position: relative;
  padding-left: 2.4rem;
  font-weight: 400;
  border-bottom: 0;

  // Bullet point
  &::before {
    content: '•';
    position: absolute;
    left: 0.8rem;
    font-size: 1.6rem;
    color: var(--krds-light-color-text-subtle, #6d7882);
  }

  // Chevron icon
  &::after {
    content: '';
    display: inline-block;
    width: 20px;
    height: 20px;
    flex-shrink: 0;
    background-image: url("https://www.krds.go.kr/resources/img/component/icon/ico_angle.svg");
    background-repeat: no-repeat;
    background-position: center;
    background-size: contain;
    transition: transform 0.2s ease;
  }

  &[data-state='open']::after {
    transform: rotate(180deg);
  }

  &:hover {
    background-color: transparent;
    text-decoration: underline;
  }
}

// 4th Depth: Title button (visual only)
.lnb-btn-tit {
  display: block;
  width: 100%;
  padding: 0.8rem 0.8rem 0.8rem 4rem;
  font-size: 17px;
  font-weight: 500;
  line-height: 1.5;
  color: var(--krds-light-color-text-basic, #1e2124);
  text-align: left;
  background: transparent;
  border: 0;
  cursor: default;
}

// 4th Depth: Submenu Level 2 container
.lnb-submenu-lv2 {
  overflow: hidden;

  &[data-state='open'] {
    animation: slideDown 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  &[data-state='closed'] {
    animation: slideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  > ul {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  // 4th Depth items
  li {
    .lnb-btn {
      padding-left: 4rem;
      font-size: 17px;

      &::before {
        left: 2.4rem;
      }
    }
  }
}

// Animations
@keyframes slideDown {
  from {
    height: 0;
    opacity: 0;
  }
  to {
    height: var(--radix-accordion-content-height);
    opacity: 1;
  }
}

@keyframes slideUp {
  from {
    height: var(--radix-accordion-content-height);
    opacity: 1;
  }
  to {
    height: 0;
    opacity: 0;
  }
}

// Dark Mode Support
@media (prefers-color-scheme: dark) {
  .krds-side-navigation {
    background-color: var(--krds-dark-color-surface-white, #1e2124);
  }

  .lnb-tit {
    border-bottom-color: var(--krds-dark-color-divider-gray-dark, #4b5563);
    color: var(--krds-dark-color-text-basic, #f9fafb);
  }

  .lnb-btn {
    border-bottom-color: var(--krds-dark-color-divider-gray-light, #374151);
    color: var(--krds-dark-color-text-basic, #f9fafb);

    &:hover {
      background-color: var(
        --krds-dark-color-action-secondary-hover,
        rgba(255, 255, 255, 0.08)
      );
    }

    &[aria-current='page'] {
      color: var(--krds-dark-color-action-primary, #3b82f6);
    }
  }

  .lnb-toggle::after,
  .lnb-toggle-popup::after {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 20 20' fill='none'%3E%3Cpath d='M5 7.5L10 12.5L15 7.5' stroke='%23f9fafb' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
  }

  .lnb-item.active > .lnb-btn.lnb-toggle::after {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 20 20' fill='none'%3E%3Cpath d='M5 7.5L10 12.5L15 7.5' stroke='%233b82f6' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
  }

  .lnb-subitem .lnb-btn::before,
  .lnb-toggle-popup::before {
    color: var(--krds-dark-color-text-subtle, #9ca3af);
  }

  .lnb-subitem.active > .lnb-btn,
  .lnb-subitem .lnb-btn[aria-current='page'] {
    color: var(--krds-dark-color-action-primary, #3b82f6);

    &::before {
      color: var(--krds-dark-color-action-primary, #3b82f6);
    }
  }
}

// Reduced Motion Support
@media (prefers-reduced-motion: reduce) {
  .lnb-toggle::after,
  .lnb-toggle-popup::after {
    transition: none;
  }

  .lnb-submenu,
  .lnb-submenu-lv2 {
    &[data-state='open'],
    &[data-state='closed'] {
      animation: none;
    }
  }
}
